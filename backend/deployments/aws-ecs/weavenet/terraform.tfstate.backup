{
    "version": 3,
    "terraform_version": "0.8.7",
    "serial": 0,
    "lineage": "692003bc-8fa2-40f0-9955-fe374178358c",
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {},
            "resources": {
                "aws_cloudwatch_log_group.velocityci": {
                    "type": "aws_cloudwatch_log_group",
                    "depends_on": [],
                    "primary": {
                        "id": "velocity_ci_cluster.velocityci-container-logs",
                        "attributes": {
                            "arn": "arn:aws:logs:eu-west-2:618010546189:log-group:velocity_ci_cluster.velocityci-container-logs:*",
                            "id": "velocity_ci_cluster.velocityci-container-logs",
                            "name": "velocity_ci_cluster.velocityci-container-logs",
                            "retention_in_days": "3",
                            "tags.%": "1",
                            "tags.Name": "Velocity CI"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_ecs_task_definition.architect": {
                    "type": "aws_ecs_task_definition",
                    "depends_on": [
                        "data.template_file.ecs_def_architect"
                    ],
                    "primary": {
                        "id": "velocity_architect",
                        "attributes": {
                            "arn": "arn:aws:ecs:eu-west-2:618010546189:task-definition/velocity_architect:1",
                            "container_definitions": "c65953c5e32bfcc5eaad51f94f6191b560170326",
                            "family": "velocity_architect",
                            "id": "velocity_architect",
                            "network_mode": "",
                            "placement_constraints.#": "0",
                            "revision": "1",
                            "task_role_arn": ""
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_ecs_task_definition.builder": {
                    "type": "aws_ecs_task_definition",
                    "depends_on": [
                        "aws_iam_role.builder",
                        "data.template_file.ecs_def_builder"
                    ],
                    "primary": {
                        "id": "velocity_builder",
                        "attributes": {
                            "arn": "arn:aws:ecs:eu-west-2:618010546189:task-definition/velocity_builder:1",
                            "container_definitions": "e31c9c16f19dac0ee8bea472e5c33feca14d316f",
                            "family": "velocity_builder",
                            "id": "velocity_builder",
                            "network_mode": "",
                            "placement_constraints.#": "0",
                            "revision": "1",
                            "task_role_arn": "arn:aws:iam::618010546189:role/ecs.velocityci.builder",
                            "volume.#": "2",
                            "volume.1627699014.host_path": "/var/run/docker.sock",
                            "volume.1627699014.name": "docker-engine",
                            "volume.1640539676.host_path": "/opt/velocityci",
                            "volume.1640539676.name": "velocity-workspace"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_ecs_task_definition.web": {
                    "type": "aws_ecs_task_definition",
                    "depends_on": [
                        "data.template_file.ecs_def_web"
                    ],
                    "primary": {
                        "id": "velocity_web",
                        "attributes": {
                            "arn": "arn:aws:ecs:eu-west-2:618010546189:task-definition/velocity_web:1",
                            "container_definitions": "2677105c51810c03a8cb6f1cd4f658c98df5b9d3",
                            "family": "velocity_web",
                            "id": "velocity_web",
                            "network_mode": "",
                            "placement_constraints.#": "0",
                            "revision": "1",
                            "task_role_arn": ""
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_iam_role.builder": {
                    "type": "aws_iam_role",
                    "depends_on": [],
                    "primary": {
                        "id": "ecs.velocityci.builder",
                        "attributes": {
                            "arn": "arn:aws:iam::618010546189:role/ecs.velocityci.builder",
                            "assume_role_policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowECSTasksAssumeRole\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n",
                            "create_date": "2018-08-10T19:38:59Z",
                            "id": "ecs.velocityci.builder",
                            "name": "ecs.velocityci.builder",
                            "path": "/",
                            "unique_id": "AROAIIHQO2W66NSCFMGTO"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "aws_iam_role_policy.builder": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.builder"
                    ],
                    "primary": {
                        "id": "ecs.velocityci.builder:ecs.velocityci.builder",
                        "attributes": {
                            "id": "ecs.velocityci.builder:ecs.velocityci.builder",
                            "name": "ecs.velocityci.builder",
                            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"*\",\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
                            "role": "ecs.velocityci.builder"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "data.template_file.ecs_def_architect": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "fd6f28a098ff8c0879d9864af3218c9ee45b6d25afc18997ec13e6c714ca0166",
                        "attributes": {
                            "id": "fd6f28a098ff8c0879d9864af3218c9ee45b6d25afc18997ec13e6c714ca0166",
                            "rendered": "[\n    {\n        \"name\": \"velocityci_architect\",\n        \"image\": \"civelocity/architect:1.0\",\n        \"memoryReservation\": 128,\n        \"hostname\": \"velocityci-architect.weave.local\",\n        \"essential\": true,\n        \"portMappings\": [\n            {\n                \"containerPort\": 80\n            }\n        ],\n        \"logConfiguration\": {\n            \"logDriver\": \"awslogs\",\n            \"options\": {\n                \"awslogs-group\": \"velocity_ci_cluster.velocityci-container-logs\",\n                \"awslogs-region\": \"eu-west-2\",\n                \"awslogs-stream-prefix\": \"architect\"\n            }\n        },\n        \"environment\": [\n            {\n                \"name\": \"WEAVE_CIDR\",\n                \"value\": \"net:172.31.0.0/20\"\n            },\n            {\n                \"Name\": \"JWT_SECRET\",\n                \"Value\": \"D33pth0ught\"\n            },\n            {\n                \"Name\": \"BUILDER_SECRET\",\n                \"Value\": \"D33pth0ught\"\n            },\n            {\n                \"Name\": \"ADMIN_PASSWORD\",\n                \"Value\": \"\"\n            },\n            {\n                \"Name\": \"PORT\",\n                \"Value\": \"80\"\n            }\n        ],\n        \"dockerLabels\": {}\n    }\n]",
                            "template": "[\n    {\n        \"name\": \"velocityci_architect\",\n        \"image\": \"civelocity/architect:${version}\",\n        \"memoryReservation\": 128,\n        \"hostname\": \"velocityci-architect.weave.local\",\n        \"essential\": true,\n        \"portMappings\": [\n            {\n                \"containerPort\": 80\n            }\n        ],\n        \"logConfiguration\": {\n            \"logDriver\": \"awslogs\",\n            \"options\": {\n                \"awslogs-group\": \"${logs_group}\",\n                \"awslogs-region\": \"${logs_region}\",\n                \"awslogs-stream-prefix\": \"architect\"\n            }\n        },\n        \"environment\": [\n            {\n                \"name\": \"WEAVE_CIDR\",\n                \"value\": \"net:${weave_cidr}\"\n            },\n            {\n                \"Name\": \"JWT_SECRET\",\n                \"Value\": \"${jwt_secret}\"\n            },\n            {\n                \"Name\": \"BUILDER_SECRET\",\n                \"Value\": \"${builder_secret}\"\n            },\n            {\n                \"Name\": \"ADMIN_PASSWORD\",\n                \"Value\": \"${admin_password}\"\n            },\n            {\n                \"Name\": \"PORT\",\n                \"Value\": \"80\"\n            }\n        ],\n        \"dockerLabels\": ${architect_labels}\n    }\n]",
                            "vars.%": "8",
                            "vars.admin_password": "",
                            "vars.architect_labels": "{}",
                            "vars.builder_secret": "D33pth0ught",
                            "vars.jwt_secret": "D33pth0ught",
                            "vars.logs_group": "velocity_ci_cluster.velocityci-container-logs",
                            "vars.logs_region": "eu-west-2",
                            "vars.version": "1.0",
                            "vars.weave_cidr": "172.31.0.0/20"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "data.template_file.ecs_def_builder": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "3851f2fc33d5d8fe539e5bc75ce2d40618377ad1b632eaa12054f1dcec6ad3ba",
                        "attributes": {
                            "id": "3851f2fc33d5d8fe539e5bc75ce2d40618377ad1b632eaa12054f1dcec6ad3ba",
                            "rendered": "[\n    {\n        \"name\": \"velocityci_builder\",\n        \"image\": \"civelocity/builder:1.0\",\n        \"memoryReservation\": 128,\n        \"essential\": true,\n        \"mountPoints\": [\n            {\n                \"sourceVolume\": \"docker-engine\",\n                \"containerPath\": \"/var/run/docker.sock\"\n            },\n            {\n                \"sourceVolume\": \"velocity-workspace\",\n                \"containerPath\": \"/opt/velocityci\"\n            }\n        ],\n        \"logConfiguration\": {\n            \"logDriver\": \"awslogs\",\n            \"options\": {\n                \"awslogs-group\": \"velocity_ci_cluster.velocityci-container-logs\",\n                \"awslogs-region\": \"eu-west-2\",\n                \"awslogs-stream-prefix\": \"builder\"\n            }\n        },\n        \"environment\": [\n            {\n                \"name\": \"WEAVE_CIDR\",\n                \"value\": \"net:172.31.0.0/20\"\n            },\n            {\n                \"Name\": \"ARCHITECT_ADDRESS\",\n                \"Value\": \"http://velocityci-architect.weave.local\"\n            },\n            {\n                \"Name\": \"BUILDER_SECRET\",\n                \"Value\": \"D33pth0ught\"\n            }\n        ]\n    }\n]",
                            "template": "[\n    {\n        \"name\": \"velocityci_builder\",\n        \"image\": \"civelocity/builder:${version}\",\n        \"memoryReservation\": 128,\n        \"essential\": true,\n        \"mountPoints\": [\n            {\n                \"sourceVolume\": \"docker-engine\",\n                \"containerPath\": \"/var/run/docker.sock\"\n            },\n            {\n                \"sourceVolume\": \"velocity-workspace\",\n                \"containerPath\": \"/opt/velocityci\"\n            }\n        ],\n        \"logConfiguration\": {\n            \"logDriver\": \"awslogs\",\n            \"options\": {\n                \"awslogs-group\": \"${logs_group}\",\n                \"awslogs-region\": \"${logs_region}\",\n                \"awslogs-stream-prefix\": \"builder\"\n            }\n        },\n        \"environment\": [\n            {\n                \"name\": \"WEAVE_CIDR\",\n                \"value\": \"net:${weave_cidr}\"\n            },\n            {\n                \"Name\": \"ARCHITECT_ADDRESS\",\n                \"Value\": \"http://velocityci-architect.weave.local\"\n            },\n            {\n                \"Name\": \"BUILDER_SECRET\",\n                \"Value\": \"${builder_secret}\"\n            }\n        ]\n    }\n]",
                            "vars.%": "5",
                            "vars.builder_secret": "D33pth0ught",
                            "vars.logs_group": "velocity_ci_cluster.velocityci-container-logs",
                            "vars.logs_region": "eu-west-2",
                            "vars.version": "1.0",
                            "vars.weave_cidr": "172.31.0.0/20"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "data.template_file.ecs_def_web": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "fefb38ebd52559dacb904737c3110ad98caa8af513c622eda10c9ccfd5393e91",
                        "attributes": {
                            "id": "fefb38ebd52559dacb904737c3110ad98caa8af513c622eda10c9ccfd5393e91",
                            "rendered": "[\n    {\n        \"name\": \"velocityci_web\",\n        \"image\": \"civelocity/web:1.0\",\n        \"memoryReservation\": 128,\n        \"hostname\": \"velocityci-web.weave.local\",\n        \"essential\": true,\n        \"portMappings\": [\n            {\n                \"containerPort\": 80\n            }\n        ],\n        \"logConfiguration\": {\n            \"logDriver\": \"awslogs\",\n            \"options\": {\n                \"awslogs-group\": \"velocity_ci_cluster.velocityci-container-logs\",\n                \"awslogs-region\": \"eu-west-2\",\n                \"awslogs-stream-prefix\": \"web\"\n            }\n        },\n        \"environment\": [\n            {\n                \"name\": \"WEAVE_CIDR\",\n                \"value\": \"net:172.31.0.0/20\"\n            },\n            {\n                \"name\": \"ARCHITECT_ENDPOINT\",\n                \"value\": \"http://eddylane.co.uk/v1\"\n            }\n        ],\n        \"dockerLabels\": {}\n    }\n]",
                            "template": "[\n    {\n        \"name\": \"velocityci_web\",\n        \"image\": \"civelocity/web:${version}\",\n        \"memoryReservation\": 128,\n        \"hostname\": \"velocityci-web.weave.local\",\n        \"essential\": true,\n        \"portMappings\": [\n            {\n                \"containerPort\": 80\n            }\n        ],\n        \"logConfiguration\": {\n            \"logDriver\": \"awslogs\",\n            \"options\": {\n                \"awslogs-group\": \"${logs_group}\",\n                \"awslogs-region\": \"${logs_region}\",\n                \"awslogs-stream-prefix\": \"web\"\n            }\n        },\n        \"environment\": [\n            {\n                \"name\": \"WEAVE_CIDR\",\n                \"value\": \"net:${weave_cidr}\"\n            },\n            {\n                \"name\": \"ARCHITECT_ENDPOINT\",\n                \"value\": \"${architect_endpoint}\"\n            }\n        ],\n        \"dockerLabels\": ${web_labels}\n    }\n]",
                            "vars.%": "6",
                            "vars.architect_endpoint": "http://eddylane.co.uk/v1",
                            "vars.logs_group": "velocity_ci_cluster.velocityci-container-logs",
                            "vars.logs_region": "eu-west-2",
                            "vars.version": "1.0",
                            "vars.weave_cidr": "172.31.0.0/20",
                            "vars.web_labels": "{}"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        }
    ]
}
